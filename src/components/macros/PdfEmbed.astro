---
import { type Props as ContentSectionProps } from "@/components/macros/ContentSection.astro";
import type { CollectionEntry } from "astro:content";
import MediaSection from "./MediaSection.astro";

export type Props = ContentSectionProps & {
  filePath: string;
  downloadLinkText?: undefined | string;
  mediaMetadata?: CollectionEntry<"resources">["data"]["media"];
};

const {
  filePath,
  downloadLinkText,
  class: className = "",
  mediaMetadata,
  ...contentSectionProps
} = Astro.props;

const iFrameUrl = import.meta.env.PROD
  ? `https://docs.google.com/gview?url=${Astro.site}${filePath.replace("/", "")}&embedded=true`
  : `http://localhost:${import.meta.env.PORT || 4321}/${filePath.replace("/", "")}`;
---

<MediaSection
  isDownloadable
  buttonLink={Astro.site + filePath}
  buttonText={downloadLinkText || "Download"}
  mediaMetadata={mediaMetadata}
  {...contentSectionProps}
>
  <iframe
    src={iFrameUrl}
    class="aspect-[9/13] lg:aspect-square w-full bg-discrete border border-discrete"
  ></iframe>
</MediaSection>
