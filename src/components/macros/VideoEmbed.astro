---
import { type Props as MediaSectionProps } from "@/components/macros/MediaSection.astro";
import type { HTMLAttributes } from "astro/types";
import MediaSection from "./MediaSection.astro";

export type Props = MediaSectionProps & {
  url: string;
  iframeProps?: undefined | HTMLAttributes<"iframe">;
};

const { url, iframeProps = {}, buttons = [], ...otherProps } = Astro.props;
---

<MediaSection
  {...otherProps}
  buttons={buttons || [
    {
      link: url,
      text: "Auf YouTube ansehen",
    },
  ]}
>
  {
    url.startsWith("/") ? (
      <video controls class="bg-discrete border border-discrete w-full">
        <source src={url} type="video/mp4" />
      </video>
    ) : (
      <iframe
        class="w-full aspect-video bg-discrete border border-discrete"
        src={url}
        loading="lazy"
        title={otherProps.caption || "Video player"}
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        {...iframeProps}
      />
    )
  }
</MediaSection>
